apply plugin: 'java'
apply plugin: 'java-library-distribution'

repositories {
    mavenCentral()
}

dependencies {
    compile fileTree(include: ['*.jar'], dir: 'libs')
    compile project(path: ':undernet-core')
    compile 'ch.qos.logback:logback-core:1.2.3'
    compile 'ch.qos.logback:logback-classic:1.2.3'
    compile 'com.esotericsoftware.yamlbeans:yamlbeans:1.12'
}

distZip.shouldRunAfter(build)

jar {
    // Keep jar clean:
    exclude 'META-INF/*.SF', 'META-INF/*.DSA', 'META-INF/*.RSA', 'META-INF/*.MF'

    manifest {
        attributes(
                'Class-Path': configurations.runtime.files.collect { "lib/$it.name" }.join(' '),
                'Main-Class': 'me.matoosh.undernet.standalone.UnderNetStandalone'
        )
    }
}

task run(dependsOn: classes, type: JavaExec) {
    main = 'me.matoosh.undernet.standalone.UnderNetStandalone'
    classpath = sourceSets.main.runtimeClasspath
    //defaultInput = System.in
    workingDir = '/debug'
    ignoreExitValue = true
}

sourceCompatibility = "1.7"
targetCompatibility = "1.7"
